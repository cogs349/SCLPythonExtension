% python.grm
% ELEC 490/498 Group 22
% Enhancing SCL Packet Parsing Language (Python Extension)

% Harmehar Singh #:20264461
% Joel Coghlin #:20228087
% Omar Badawi #:20200423

% This is the Python Grammar file. It specifies the Python structures
% that our TXL Parser will encounter. Since Python is interpreted, and not
% compiled, the structure of the language varies slightly.

% TODO:
% undefined nonterminals: 

% =============== Lexical Properties of Python ===============
% Comments in Python
comments
    #
end comments

% Keywords in Python
keys 
    if     elif    else     for
    while  break   continue return
    True   False   None     import
    from   as      def      with
    del    global  and      or
    not    is      in       continue
    return int     break    long
    float  switch  char     default
end keys

% Compounds
compounds
    ->      <<      >>      <=      >=      ==      !=
    &&      ||      *=      /=      '%=     +=      -=
    <<=     >>=     &=      ^=      |=
end compounds

% ============================================================


% =============== Syntax of Python ===========================

% Define a python program as "Every line"
define pyprogram
    [py_program]
end define

% define "Every line" as "Functions or declarations"
define py_program
    [repeat definition_or_declaration]
end define

% define "definitions" and "declarations" (note that definitions are functions)
define definition_or_declaration
    [function_definition] | [declaration]
end define

% define a python function. Since Python functions are interpreted based on indentation,
% it is essential that the function body be surrounded by an [IN] and [EX].
define function_definition
    [NL] "def" [name][arguments]:
    [NL] [IN] [py_program] [NL] [EX]
end define

% define arguments that are contained in a function definition
% if there are multiple, they must be seperated by commas.
define arguments
    '(' [argument] | [argument] ',' [arguments] ')'
end define

% define a single argument
define argument
    [name]
end define

% a declaration is any line of code. function definitions are unique, but declarations are everything else.
define declaration
      [assignment]
    | [control_statment]
    | [import_statement]
    | [expression_statement]
end define

% Define an assignment to a variable. Empty or not.
define assignment
    [name] '=' [value] [NL]
    | [name] '=' 'None' [NL]
    | [name] '=' '[]' [NL]
    | [name] '=' '{}' [NL]
    | [name] '=' '[' [array_content] ']'
    | [name] '=' '{' [array_content] '}'
end define

define value
    [integer] | [stringlit] | [charlit] | [boolean] | [float] | [long]
end define

define integer
    [repeat digit+]
end define

define digit
    [0123456789]
end define

%